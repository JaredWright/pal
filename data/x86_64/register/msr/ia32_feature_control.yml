- name: ia32_feature_control
  long_name: ia32_feature_control
  purpose: "Control Features in Intel 64 Processor"
  size: 64
  
  access_mechanisms:
      - name: rdmsr
        address: 0x3A
  
      - name: wrmsr
        address: 0x3A

  fieldsets:
      - name: latest
        condition: "Fieldset valid on latest version of the Intel architecture"
        size: 64
        reserved0_mask: 0xFFFFFFFFFFF900F8

        fields:
            - name: lock_bit
              long_name: "Lock bit"
              lsb: 0
              msb: 0
              mask: 0x0000000000000001
              readable: True
              writable: True
              lockable: False
              write_once: True
              write_1_clear: False
              description: |
                  "
                  Lock bit (R/WO): (1 = locked). When set, locks this MSR from
                  being written; writes to this bit will result in GP(0).
                  Note: Once the Lock bit is set, the contents of this register
                  cannot be modified.  Therefore the lock bit must be set after
                  configuring support for Intel Virtualization Technology and
                  prior to transferring control to an option ROM or the OS.
                  Hence, once the Lock bit is set, the entire
                  IA32_FEATURE_CONTROL contents are preserved across RESET when
                  PWRGOOD is not deasserted.
                  "
              access_constraint: |
                  "
                  If any one enumeration condition for defined bit field
                  position greater than bit 0 holds.
                  "

            - name: enable_vmx_inside_smx
              long_name: "Enable VMX inside SMX operation"
              lsb: 1
              msb: 1
              mask: 0x0000000000000002
              readable: True
              writable: True
              lockable: True
              write_once: False
              write_1_clear: False
              description: |
                  "
                  Enable VMX inside SMX operation (R/WL): This bit enables a
                  system executive to use VMX in conjunction with SMX to
                  support IntelÂ® Trusted Execution Technology.  BIOS must set
                  this bit only when the CPUID function 1 returns VMX feature
                  flag and SMX feature flag set (ECX bits 5 and 6 respectively)
                  "
              access_constraint: |
                  "
                  CPUID.01H:ECX[5] = 1 && CPUID.01H:ECX[6] = 1
                  "

            - name: enable_vmx_outside_smx
              long_name: "Enable VMX outside SMX operation"
              lsb: 2
              msb: 2
              mask: 0x0000000000000004
              readable: True
              writable: True
              lockable: False
              write_once: False
              write_1_clear: False
              description: |
                  "
                  Enable VMX outside SMX operation (R/WL): This bit enables VMX
                  for a system executive that does not require SMX.  BIOS must
                  set this bit only when the CPUID function 1 returns the VMX
                  feature flag set (ECX bit 5)
                  "
              access_constraint: |
                  "
                  If CPUID.01H:ECX[5] = 1
                  "

            - name: senter_local_function_enables
              long_name: "SENTER Local Function Enables"
              lsb: 8
              msb: 14 
              mask: 0x0000000000007F00
              readable: True
              writable: True
              lockable: False
              write_once: False
              write_1_clear: False
              description: |
                  "
                  SENTER Local Function Enables (R/WL): When set, each bit in
                  the field represents an enable control for a corresponding
                  SENTER function. This field is supported only if
                  CPUID.1:ECX.[bit 6] is set.
                  "
              access_constraint: |
                  "
                  If CPUID.01H:ECX[6] = 1
                  "

            - name: senter_global_enable
              long_name: "SENTER Global Enable"
              lsb: 15
              msb: 15 
              mask: 0x0000000000008000
              readable: True
              writable: True
              lockable: False
              write_once: False
              write_1_clear: False
              description: |
                  "
                  SENTER Global Enable (R/WL): This bit must be set to enable
                  SENTER leaf functions.  This bit is supported only if
                  CPUID.1:ECX.[bit 6] is set.
                  "
              access_constraint: |
                  "
                  If CPUID.01H:ECX[6] = 1
                  "

            - name: sgx_launch_control_enable
              long_name: "SGX Launch Control Enable"
              lsb: 17
              msb: 17 
              mask: 0x0000000000020000
              readable: True
              writable: True
              lockable: False
              write_once: False
              write_1_clear: False
              description: |
                  "
                  SGX Launch Control Enable (R/WL): This bit must be set to
                  enable runtime reconfiguration of SGX Launch Control via the
                  IA32_SGXLEPUBKEYHASHn MSR. 
                  "
              access_constraint: |
                  "
                  If CPUID.(EAX=07H, ECX=0H): ECX[30] = 1
                  "

            - name: sgx_global_enable
              long_name: "SGX Global Enable"
              lsb: 18
              msb: 18 
              mask: 0x0000000000040000
              readable: True
              writable: True
              lockable: False
              write_once: False
              write_1_clear: False
              description: |
                  "
                  SGX Global Enable (R/WL): This bit must be set to enable SGX
                  leaf functions.
                  "
              access_constraint: |
                  "
                  If CPUID.(EAX=07H, ECX=0H): EBX[2] = 1
                  "

            - name: lmce
              long_name: "LMCE On"
              lsb: 20
              msb: 20 
              mask: 0x0000000000100000
              readable: True
              writable: True
              lockable: False
              write_once: False
              write_1_clear: False
              description: |
                  "
                  LMCE On (R/WL): When set, system software can program the
                  MSRs associated with LMCE to configure delivery of some
                  machine check exceptions to a single logical processor.
                  "
              access_constraint: |
                  "
                  If IA32_MCG_CAP[27] = 1
                  "
